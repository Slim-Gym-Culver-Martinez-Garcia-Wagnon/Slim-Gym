<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="UTF-8"/>
    <title>Edit your profile</title>
    <th:block th:include="partials/styles.html :: styles"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
</head>
<body>
<th:block th:replace="partials/navbar.html :: navbar"/>
<h2>Edit your profile:</h2>
<form th:action="@{/user/edit/update/{id}(id=${id})}" th:method="POST" th:object="${user}">

    <input th:value="*{first_name}" type="hidden" id="first_name" class="form-control" th:field="*{first_name}">
    <input th:value="*{last_name}" type="hidden" id="last_name" class="form-control" th:field="*{last_name}">
    <input th:value="*{username}" type="hidden" id="username" class="form-control" th:field="*{username}">

    <div class="mb-3">
        <label for="email" class="form-label">Email address: </label>
        <input class="form-control" id="email" th:value="*{email}" th:field="*{email}"/>
    </div>
    <div class="mb-3">
        <label for="password" class="form-label">New password: </label>
        <input th:value="*{password}" type="password" class="form-control" id="password" th:field="*{password}">
    </div>

    <div class="mb-3">
        <img id="oldpic" th:src="*{profile_pic}" alt="User profile picture" style="height: 250px">
        <br>
        <div id="thumbnail-container"></div>
        <label for="fileupload">Select a file to upload</label>
        <input th:value="*{profile_pic}" type="hidden" id="fileupload" th:field="*{profile_pic}">
        <button id="picker" type="button">Pick file</button>
    </div>

    <p>Update your emergency contact:</p>
    <div class="mb-3">
        <label for="emergency_first_name" class="form-label">First Name: </label>
        <input th:value="*{emergency_first_name}" type="text" class="form-control" id="emergency_first_name"
               th:field="*{emergency_first_name}">
    </div>
    <div class="mb-3">
        <label for="emergency_last_name" class="form-label">Last Name: </label>
        <input th:value="*{emergency_last_name}" type="text" class="form-control" id="emergency_last_name"
               th:field="*{emergency_last_name}">
    </div>
    <div class="mb-3">
        <label for="emergency_phone_number" class="form-label">Phone Number: </label>
        <input th:value="*{emergency_phone_number}" type="text" class="form-control" id="emergency_phone_number"
               th:field="*{emergency_phone_number}">
    </div>
    <button type="submit" class="btn btn-primary">Save Changes</button>
</form>

<!--<script src="https://code.jquery.com/jquery-3.6.0.slim.js"-->
<!--        integrity="sha256-HwWONEZrpuoh951cQD1ov2HUK5zA5DwJ1DNUXaM6FsY=" crossorigin="anonymous"></script>-->
<!--<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>-->
<script>
    // // Set up the picker
    // const client = filestack.init('AR2VI3jLQyWEkkv3AJ6Psz');
    // const options = {
    //     onUploadDone: updateForm,
    //     maxSize: 10 * 1024 * 1024,
    //     accept: 'image/*',
    //     uploadInBackground: false,
    // };
    // const picker = client.picker(options);
    //
    // // Get references to the DOM elements
    //
    // const form = document.getElementById('pick-form');
    // const fileInput = document.getElementById('fileupload');
    // const btn = document.getElementById('picker');
    // const nameBox = document.getElementById('nameBox');
    // const urlBox = document.getElementById('urlBox');
    //
    // // Add our event listeners
    //
    // btn.addEventListener('click', function (e) {
    //     e.preventDefault();
    //     picker.open();
    // });
    //
    // form.addEventListener('submit', function (e) {
    //     e.preventDefault();
    //     alert('Submitting: ' + fileInput.value);
    // });
    //
    // // Helper to overwrite the field input value
    //
    // function updateForm(result) {
    //     const fileData = result.filesUploaded[0];
    //     fileInput.value = fileData.url;
    //
    //     const name = document.createTextNode('Selected: ' + fileData.filename);
    //     const url = document.createElement('a');
    //     url.href = fileData.url;
    //     url.appendChild(document.createTextNode(fileData.url));
    //     nameBox.appendChild(name);
    //     urlBox.appendChild(document.createTextNode('Uploaded to: '));
    //     urlBox.appendChild(url);
    // };

</script>
<th:block th:include="partials/scripts.html :: script"/>

</body>
</html>